- 리소스 풀 전체에 네트워크 트래픽을 균등하게 배포하는 방법
	- 서버에 가해지는 부하(로드)를 분산(밸런싱) 하는 장치, 기술
	- 클라이언트와 서버 풀 사이에 위치
	- **한 서버로 부하가 집중되지 않도록 트래픽을 관리**
	- **각 서버가 최적의 퍼포먼스를 보일 수 있도록 함.**

---
# Load-Balencing
: 여러 대 서버를 두고 서비스를 제공하는 분산처리 시스템에서 필요한 기술

## Why we need Load-Balencing?
- 서버 초기에는 적은 수의 클라이언트로 1개 서버로 요청하는 것이 가능
- 시간이 지남에 따라 클라이언트 수가 늘어나고, 기존 서버로 한계 봉착
	- 이를 해결하기 위해 2가지 옵션이 있음
1. Scale-up
	- 서버 자체의 성능을 확장
	- 서버 업그레이드(intel i3 -> intel i7)
2. Scale-out
	- 기존 서버와 동일하거나 낮은 성능의 서버를 2대 이상 증설하여 운영
	- **여러 대의 서버를 운영하므로 로드밸런싱이 필요함.**

---
## Load-Balencing Algorithms

- 라운드 로빈(Round Robin Method)
	- 서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식
	- 서버가 동 스펙을 가지고(순차로 분배) 세션이 오래 지속되지 않을 때 적합
	---
- 가중 라운드 로빈 방식(Weighted Round Robin Method)
	- 각각 서버마다 가중치 부여
	- 가중치가 높은 서버에 클라이언트 우선순위 부여
	- 서버의 트래픽 처리 능력이 상이할 경우에 사용
	- 예시)
		- A 서버 가중치 5 / B 서버 가중치 2 일 경우,
		- A에 5개, B에 2개 요청 전달
	---
- IP 해시 방식(IP Hash Method)
	- 클라이언트의 IP 주소를 특정 서버로 매핑하여 요청 처리
	- User IP **Hashing**하여 로드 분배
	- (임의 길이를 지닌 데이터를 고정된 길이의 데이터로 매핑, 또는 그런 함수)
	- 사용자가 동일 서버로 접속하는것을 보장함.
	---
- 최소 연결 방식(Least Connection Method)
	- 요청 시점에 가장 적은 연결 상태를 보이는 서버에 트래픽 분배
	- 세션이 자주 길어지거나, 분배된 트래픽들이 일정하지 않은 경우 적합
	---
- 최소 리스폰 타임(Least Response Time Method)
	- 서버의 현재 연결 상태와 **응답시간**을 모두 고려하여 트래픽 배분
	(서버에 요청 전달 후 최초 응답까지 소요시간)
	- 가장 적은 연결 상태와 가장 짧은 응답시간을 보이는 서버에 우선 배분
	
---

### Kinds of Load-Balencer
- 현재 가장 많이 사용되는 로드 밸런서의 종류
- **L4 부터 포트(Port) 정보를 바탕으로 로드를 분산하는 것이 가능함.**
- 다수의 서버를 운영하는 경우 최소 L4를 이용함!

#### L4 & L7
: OSI 7 Layer 에서 유래
- 상위 계층으로 갈수록 더 정교한 로드밸런싱이 가능함.

#### L4 Load-Balencing

<img src="image\20240123200610.png"/>

- 네트워크 계층(IP, IPX)이나 Transport 계층(TCP, UDP)의 정보를 바탕으로 분산
- IP 주소, 포트 번호, MAC 주소, 전송 프로토콜에 따라 트래픽 분산 가능

#### L7 Load-Balencing

<img src="image\20240123200942.png"/>

- 애플리케이션 계층(Http, FTP, SMTP)에서 로드 분산
- HTTP 헤더, 쿠키 등 사용자 요청을 기준으로 특정 서버 트래픽 분산 가능
	- 패킷의 내용 확인 후 내용에 따라 로드 분배
- 클라이언트의 요청을 보다 세분화하여 서버에 전달할 수 있다.
- 네트워크 보안 분야에도 활용
	- 특정 패턴을 가진 바이러스를 감지하여 보호 가능
	- Dos / DDos 같은 비정상 트래픽을 필터링

---
#### L4와 L7 로드밸런서 비교표

  <img src="image\20240123202122.png"/>

---
